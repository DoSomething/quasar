{"results": [{"node": {"name": "users", "root_path": "/Users/mrich/projects/quasar/quasar/dbt", "resource_type": "model", "path": "users_table/users.sql", "original_file_path": "models/users_table/users.sql", "package_name": "ds_dbt", "raw_sql": "SELECT\n\tu.id,\n\tu.created_at,\n\tumax.max_last_auth AS last_logged_in,\n\tumax.max_last_access AS last_accessed,\n\tumax.max_last_message AS last_messaged_at,\n\tu.drupal_id AS drupal_uid,\n\tu.\"source\",\n\tu.email,\n\tu.facebook_id,\n\tu.mobile,\n\tCASE WHEN\n\t\tu.birthdate < '1900-01-01' OR \n\t\tu.birthdate > (date('now') - INTERVAL '10 years') \n\t\tTHEN NULL ELSE u.birthdate END AS birthdate,\n\tu.first_name,\n\tu.last_name,\n\tu.voter_registration_status,\n\tu.addr_street1 AS address_street_1,\n\tu.addr_street2 AS address_street_2,\n\tu.addr_city AS city,\n\tu.addr_state AS state,\n\tu.addr_zip AS zipcode,\n\tu.country,\n\tu.\"language\",\n\temail_status.event_type AS cio_status,\n\temail_status.\"timestamp\" AS cio_status_timestamp,\n\tu.sms_status,\n\tu.source_detail,\n\tsubstring(u.source_detail from '(?<=utm_medium\\:)(\\w*)') AS utm_medium,\n\tsubstring(u.source_detail from '(?<=utm_source\\:)(\\w*)') AS utm_source,\n\tsubstring(u.source_detail from '(?<=utm_campaign\\:)(\\w*)') AS utm_campaign,\n\t(u.feature_flags #>> '{badges}')::boolean as badges,\n\t(u.feature_flags #>> '{refer-friends}')::boolean as refer_friends,\n\t(u.feature_flags #>> '{refer-friends-scholarship}')::boolean as refer_friends_scholarship,\n\tCASE WHEN\n\t\tu.sms_status in ('active','less','pending') OR\n\t\temail_status.event_type = 'customer_subscribed' \n\t\tTHEN TRUE ELSE FALSE END AS subscribed_member,\n\tumax.max_update AS last_updated_at,\n\tu.school_id\nFROM {{ source('northstar', 'users') }} u\nINNER JOIN\n\t(SELECT\n\t\tutemp.id,\n\t\tmax(utemp.updated_at) AS max_update,\n\t\tmax(utemp.last_accessed_at) AS max_last_access,\n\t\tmax(utemp.last_authenticated_at) AS max_last_auth,\n\t\tmax(utemp.last_messaged_at) AS max_last_message\n\tFROM {{ source('northstar', 'users') }} utemp\n\tGROUP BY utemp.id) umax ON umax.id = u.id AND umax.max_update = u.updated_at\nLEFT JOIN {{ ref('cio_latest_status') }} email_status ON email_status.customer_id = u.id\nWHERE\n\t(u.\"source\" IS DISTINCT FROM 'runscope'\n\tAND u.\"source\" IS DISTINCT FROM 'runscope-client'\n\tAND u.email NOT SIMILAR TO '%runscope%@%'\n\tAND u.email NOT SIMILAR TO '%@%dosomething%') OR u.email IS NULL", "refs": [["cio_latest_status"]], "sources": [["northstar", "users"], ["northstar", "users"]], "depends_on": {"nodes": ["source.ds_dbt.northstar.users", "source.ds_dbt.northstar.users", "model.ds_dbt.cio_latest_status"], "macros": []}, "unique_id": "model.ds_dbt.users", "empty": false, "fqn": ["ds_dbt", "users_table", "users"], "tags": [], "config": {"enabled": true, "materialized": "table", "pre-hook": [], "post-hook": [{"sql": "CREATE UNIQUE INDEX IF NOT EXISTS du_indicies ON {{ this }}(northstar_id, created_at, email, mobile, source)", "transaction": true, "index": 0}, {"sql": "GRANT SELECT ON {{ this }} TO dsanalyst", "transaction": true, "index": 1}, {"sql": "GRANT SELECT ON {{ this }} TO looker", "transaction": true, "index": 2}, {"sql": "GRANT SELECT ON {{ this }} TO public", "transaction": true, "index": 3}], "tags": [], "quoting": {}, "persist_docs": {}, "vars": {}, "column_types": {}, "alias": "users"}, "schema": "public", "database": "quasar", "alias": "users", "columns": {"northstar_id": {"name": "northstar_id", "description": "The Northstar ID of the user who generated the event"}, "created_at": {"name": "created_at", "description": "When the item was created in UTC (eg. 2018-01-01 12:00:00)"}, "last_logged_in": {"name": "last_logged_in", "description": "Date time in UTC when user last logged in to Northstar"}, "last_accessed": {"name": "last_accessed", "description": "Date time in UTC when user last access the website"}, "last_messaged_at": {"name": "last_messaged_at", "description": "Date time in UTC when user was last sent a message via SMS or email"}, "source": {"name": "source", "description": "Source of the URL (e.g. SMS, web), origin of the post (e.g. phoenix-web, phoenix-ashes, sms), or source where user was acquired. (e.g. sms, phoenix-next)"}, "email": {"name": "email", "description": "Email address of the user."}, "facebook_id": {"name": "facebook_id", "description": "User's facebook id"}, "mobile": {"name": "mobile", "description": "Users's mobile phone number"}, "birthdate": {"name": "birthdate", "description": "User's birthdate"}, "first_name": {"name": "first_name", "description": "User's first name"}, "last_name": {"name": "last_name", "description": "User's last name"}, "voter_registration_status": {"name": "voter_registration_status", "description": "User's registration status. (e.g. registration_complete, confirmed, uncertain)"}, "address_street_1": {"name": "address_street_1", "description": "First line of user's street address"}, "address_street_2": {"name": "address_street_2", "description": "Second line of user's street address"}, "city": {"name": "city", "description": "User's city"}, "state": {"name": "state", "description": "User's state"}, "zipcode": {"name": "zipcode", "description": "Postal code where the action takes place"}, "country": {"name": "country", "description": "User's country"}, "language": {"name": "language", "description": "User's language"}, "cio_status": {"name": "cio_status", "description": "Status of user from CIO. (e.g. customer_subscribed, customer_unsubscribed)"}, "cio_status_timestamp": {"name": "cio_status_timestamp", "description": "Timestamp when users's status was updated."}, "sms_status": {"name": "sms_status", "description": "Current SMS status. (e.g. undeliverable, unknown)"}, "source_detail": {"name": "source_detail", "description": "Details of the origin of the user. (e.g. tell_a_friend, other, opt_in_path/197981)"}, "utm_medium": {"name": "utm_medium", "description": "How the traffic got to the platform (eg. referral, CPC)"}, "utm_source": {"name": "utm_source", "description": "Tracks where the traffic is coming from. (eg. scholarship_listing, Facebook)"}, "utm_campaign": {"name": "utm_campaign", "description": "Tracks which campaign the traffic was generated by. Shows up in Google Analytics as Campaign Name (eg. editorial_newsletter)"}, "badges": {"name": "badges", "description": "Whether the user has any badges."}, "refer_friends": {"name": "refer_friends", "description": "Whether the user is a part of the refer a friend campaign."}, "subscribed_member": {"name": "subscribed_member", "description": "Whether the user is subscribed."}, "last_updated_at": {"name": "last_updated_at", "description": "Timestamp when users's was updated."}, "school_id": {"name": "school_id", "description": "Unique identifier for the user's school. This info comes from the school finder."}}, "description": "A table containing aggregated user data.", "patch_path": "models/users_table/schema.yml", "docrefs": [{"documentation_package": "", "documentation_name": "northstar_id", "column_name": "northstar_id"}, {"documentation_package": "", "documentation_name": "created_at", "column_name": "created_at"}, {"documentation_package": "", "documentation_name": "last_logged_in", "column_name": "last_logged_in"}, {"documentation_package": "", "documentation_name": "last_accessed", "column_name": "last_accessed"}, {"documentation_package": "", "documentation_name": "last_messaged_at", "column_name": "last_messaged_at"}, {"documentation_package": "", "documentation_name": "source", "column_name": "source"}, {"documentation_package": "", "documentation_name": "email", "column_name": "email"}, {"documentation_package": "", "documentation_name": "facebook_id", "column_name": "facebook_id"}, {"documentation_package": "", "documentation_name": "mobile", "column_name": "mobile"}, {"documentation_package": "", "documentation_name": "birthdate", "column_name": "birthdate"}, {"documentation_package": "", "documentation_name": "first_name", "column_name": "first_name"}, {"documentation_package": "", "documentation_name": "last_name", "column_name": "last_name"}, {"documentation_package": "", "documentation_name": "voter_registration_status", "column_name": "voter_registration_status"}, {"documentation_package": "", "documentation_name": "address_street_1", "column_name": "address_street_1"}, {"documentation_package": "", "documentation_name": "address_street_2", "column_name": "address_street_2"}, {"documentation_package": "", "documentation_name": "city", "column_name": "city"}, {"documentation_package": "", "documentation_name": "state", "column_name": "state"}, {"documentation_package": "", "documentation_name": "postal_code", "column_name": "zipcode"}, {"documentation_package": "", "documentation_name": "country", "column_name": "country"}, {"documentation_package": "", "documentation_name": "language", "column_name": "language"}, {"documentation_package": "", "documentation_name": "cio_status", "column_name": "cio_status"}, {"documentation_package": "", "documentation_name": "cio_status_timestamp", "column_name": "cio_status_timestamp"}, {"documentation_package": "", "documentation_name": "sms_status", "column_name": "sms_status"}, {"documentation_package": "", "documentation_name": "source_detail", "column_name": "source_detail"}, {"documentation_package": "", "documentation_name": "utm_medium", "column_name": "utm_medium"}, {"documentation_package": "", "documentation_name": "utm_source", "column_name": "utm_source"}, {"documentation_package": "", "documentation_name": "utm_campaign", "column_name": "utm_campaign"}, {"documentation_package": "", "documentation_name": "badges", "column_name": "badges"}, {"documentation_package": "", "documentation_name": "refer_friends", "column_name": "refer_friends"}, {"documentation_package": "", "documentation_name": "subscribed_member", "column_name": "subscribed_member"}, {"documentation_package": "", "documentation_name": "last_updated_at", "column_name": "last_updated_at"}, {"documentation_package": "", "documentation_name": "school_id", "column_name": "school_id"}], "compiled": true, "compiled_sql": "SELECT\n\tu.id,\n\tu.created_at,\n\tumax.max_last_auth AS last_logged_in,\n\tumax.max_last_access AS last_accessed,\n\tumax.max_last_message AS last_messaged_at,\n\tu.drupal_id AS drupal_uid,\n\tu.\"source\",\n\tu.email,\n\tu.facebook_id,\n\tu.mobile,\n\tCASE WHEN\n\t\tu.birthdate < '1900-01-01' OR \n\t\tu.birthdate > (date('now') - INTERVAL '10 years') \n\t\tTHEN NULL ELSE u.birthdate END AS birthdate,\n\tu.first_name,\n\tu.last_name,\n\tu.voter_registration_status,\n\tu.addr_street1 AS address_street_1,\n\tu.addr_street2 AS address_street_2,\n\tu.addr_city AS city,\n\tu.addr_state AS state,\n\tu.addr_zip AS zipcode,\n\tu.country,\n\tu.\"language\",\n\temail_status.event_type AS cio_status,\n\temail_status.\"timestamp\" AS cio_status_timestamp,\n\tu.sms_status,\n\tu.source_detail,\n\tsubstring(u.source_detail from '(?<=utm_medium\\:)(\\w*)') AS utm_medium,\n\tsubstring(u.source_detail from '(?<=utm_source\\:)(\\w*)') AS utm_source,\n\tsubstring(u.source_detail from '(?<=utm_campaign\\:)(\\w*)') AS utm_campaign,\n\t(u.feature_flags #>> '{badges}')::boolean as badges,\n\t(u.feature_flags #>> '{refer-friends}')::boolean as refer_friends,\n\t(u.feature_flags #>> '{refer-friends-scholarship}')::boolean as refer_friends_scholarship,\n\tCASE WHEN\n\t\tu.sms_status in ('active','less','pending') OR\n\t\temail_status.event_type = 'customer_subscribed' \n\t\tTHEN TRUE ELSE FALSE END AS subscribed_member,\n\tumax.max_update AS last_updated_at,\n\tu.school_id\nFROM \"quasar\".\"northstar\".\"users\" u\nINNER JOIN\n\t(SELECT\n\t\tutemp.id,\n\t\tmax(utemp.updated_at) AS max_update,\n\t\tmax(utemp.last_accessed_at) AS max_last_access,\n\t\tmax(utemp.last_authenticated_at) AS max_last_auth,\n\t\tmax(utemp.last_messaged_at) AS max_last_message\n\tFROM \"quasar\".\"northstar\".\"users\" utemp\n\tGROUP BY utemp.id) umax ON umax.id = u.id AND umax.max_update = u.updated_at\nLEFT JOIN \"quasar\".\"public\".\"cio_latest_status\" email_status ON email_status.customer_id = u.id\nWHERE\n\t(u.\"source\" IS DISTINCT FROM 'runscope'\n\tAND u.\"source\" IS DISTINCT FROM 'runscope-client'\n\tAND u.email NOT SIMILAR TO '%runscope%@%'\n\tAND u.email NOT SIMILAR TO '%@%dosomething%') OR u.email IS NULL", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "SELECT\n\tu.id,\n\tu.created_at,\n\tumax.max_last_auth AS last_logged_in,\n\tumax.max_last_access AS last_accessed,\n\tumax.max_last_message AS last_messaged_at,\n\tu.drupal_id AS drupal_uid,\n\tu.\"source\",\n\tu.email,\n\tu.facebook_id,\n\tu.mobile,\n\tCASE WHEN\n\t\tu.birthdate < '1900-01-01' OR \n\t\tu.birthdate > (date('now') - INTERVAL '10 years') \n\t\tTHEN NULL ELSE u.birthdate END AS birthdate,\n\tu.first_name,\n\tu.last_name,\n\tu.voter_registration_status,\n\tu.addr_street1 AS address_street_1,\n\tu.addr_street2 AS address_street_2,\n\tu.addr_city AS city,\n\tu.addr_state AS state,\n\tu.addr_zip AS zipcode,\n\tu.country,\n\tu.\"language\",\n\temail_status.event_type AS cio_status,\n\temail_status.\"timestamp\" AS cio_status_timestamp,\n\tu.sms_status,\n\tu.source_detail,\n\tsubstring(u.source_detail from '(?<=utm_medium\\:)(\\w*)') AS utm_medium,\n\tsubstring(u.source_detail from '(?<=utm_source\\:)(\\w*)') AS utm_source,\n\tsubstring(u.source_detail from '(?<=utm_campaign\\:)(\\w*)') AS utm_campaign,\n\t(u.feature_flags #>> '{badges}')::boolean as badges,\n\t(u.feature_flags #>> '{refer-friends}')::boolean as refer_friends,\n\t(u.feature_flags #>> '{refer-friends-scholarship}')::boolean as refer_friends_scholarship,\n\tCASE WHEN\n\t\tu.sms_status in ('active','less','pending') OR\n\t\temail_status.event_type = 'customer_subscribed' \n\t\tTHEN TRUE ELSE FALSE END AS subscribed_member,\n\tumax.max_update AS last_updated_at,\n\tu.school_id\nFROM \"quasar\".\"northstar\".\"users\" u\nINNER JOIN\n\t(SELECT\n\t\tutemp.id,\n\t\tmax(utemp.updated_at) AS max_update,\n\t\tmax(utemp.last_accessed_at) AS max_last_access,\n\t\tmax(utemp.last_authenticated_at) AS max_last_auth,\n\t\tmax(utemp.last_messaged_at) AS max_last_message\n\tFROM \"quasar\".\"northstar\".\"users\" utemp\n\tGROUP BY utemp.id) umax ON umax.id = u.id AND umax.max_update = u.updated_at\nLEFT JOIN \"quasar\".\"public\".\"cio_latest_status\" email_status ON email_status.customer_id = u.id\nWHERE\n\t(u.\"source\" IS DISTINCT FROM 'runscope'\n\tAND u.\"source\" IS DISTINCT FROM 'runscope-client'\n\tAND u.email NOT SIMILAR TO '%runscope%@%'\n\tAND u.email NOT SIMILAR TO '%@%dosomething%') OR u.email IS NULL", "wrapped_sql": "None", "build_path": "../../docs/compiled/ds_dbt/users_table/users.sql"}, "error": "Database Error in model users (models/users_table/users.sql)\n  column \"northstar_id\" does not exist\n  compiled SQL at ../../docs/compiled/ds_dbt/users_table/users.sql", "skip": false, "status": "ERROR", "fail": null, "warn": null, "execution_time": 1194.0526359081268, "thread_id": "Thread-1", "timing": []}], "generated_at": "2020-02-05T19:01:51.134776Z", "elapsed_time": 1195.3901643753052}